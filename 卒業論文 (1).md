# Y00-量子暗号のシミュレーション


## 1. はじめに

本論文では、Y00-量子暗号のシミュレーションシステムを用いて減衰通信路に対して、正規受信者の誤り率を評価する。そのとき、受信者側の最大信号強度の設定値を送信者側と一致させる場合と、受信者側の最大信号強度の設定値を減衰の効果を考慮して決める場合を比較する。



##2. Y00-量子暗号の信号状態

まず、コヒーレント状態について説明する。コヒーレント状態は、複素振幅$\alpha=x+iy$を持つ理想的なレーザー光を表す量子状態である。コヒーレント状態の複素振幅$\alpha$は複素平面上で平均$(𝑥,𝑦)^T$、共分散行列 
$$
\begin{pmatrix}
1/4&0\\
0&1/4
\end{pmatrix}
$$
の正規分布に従って揺らいでいる．図1は、平均$(𝑥,𝑦)^T$のコヒーレント状態の揺らぎを表している。

<center>
<img src="https://drive.google.com/uc?export=view&id=12IUYzYph7a_JATBVUrwjXIsZ2bupHUsp">

図１　コヒーレント状態のゆらぎ
</center>

Y00-量子暗号の信号状態について説明する。青い丸がコヒーレント状態でこれを使って通信を行う。使用する基底によって0と1に対応する信号状態が異なる。例えば基底１を使って0を送りたいときは0のコヒーレント状態を使い、1を送りたいときは0のコヒーレント状態を使う。正規の受信者と送信者はどの基底を使って通信をしているのかわかる。同じ基底のコヒーレント状態は離れているので盗聴されにくいため、安全性が保証される。$S_{max}$は信号の最大強度を表している.$b$個の規定で通信する場合間隔の個数が$2B-1$個となることから隣接信号間の間隔は$S_{max}/2B-1$になる。このことから基底$k$の信号状態は

$$
\frac{S_{max}}{2B-1},\frac{S_{max}}{2B-1}(B+k)
$$

<center>
<img src="https://drive.google.com/uc?export=view&id=18aElMj4HUK7V9YJVaHwFg-NbP-fm1zLN">

図2　量子暗号の信号状態
</center>



## 3.Y00-量子暗号システム

Y00-量子暗号のシステムについて説明する。送信者と受信者はseedkeyを共有している。まずLFSRによって疑似乱数を発生させる。
このとき、seedkeyが同じであるので発生する乱数も同じとなる。乱数は基底番号を表し、送信者と受信者は同じ基底番号を使うことができる。送信器では送信バイナリデータと基底番号の値に対応する量子状態を送信する。受信器では受け取った量子状態と基底番号を使ってバイナリデータを出力する。次に受信機における処理について説明する。
<center>
<img src="https://drive.google.com/uc?export=view&id=1FbMyzdfNxbt3eOyN1i8O3ihgGBRofI-M">

図3　量子暗号システム
</center>


受信器ではまずホモダイン測定を行う。ホモダイン測定はコヒーレント状態の複素振幅𝛼=𝑥+𝑖𝑦のx成分を測定する。図4は0と1に対応するコヒーレント状態をホモダイン測定した場合の出力の確率分布である。それぞれの分布は分散1/4の正規分布になっている。受信器では、測定値に基づき、しきい値を使って受信したデータが0か1か判断する。
<center>
<img src="https://drive.google.com/uc?export=view&id=1FQ56UyuisaeJU9aKoYu6jes1aQSv6W-d">

図4　ホモダイン測定
</center>

図5は受信機のしきい値処理を説明したものである。2つのコヒーレント状態の値のちょうど真ん中をしきい値とする。基底番号が3の場合それに対応するコヒーレント状態は緑色に示したコヒーレント状態になるが、そのときのしきい値は$\frac{S_{max}}{2B-1}(\frac{B}{2}+k)$となる。また、基底番号が奇数の場合、測定値がしきい値より大きければ1、小さければ0と判定する.基底番号が偶数の場合、測定値がしきい値より大きければ0、小さければ1と判定する。

<center>
<img src="https://drive.google.com/uc?export=view&id=1nSiUI7DfdPSctvNlj0RcQ9z1JUPvJsPD">

図5　受信器のしきい値処理
</center>



## 4.通信路に減衰がある場合

今回の評価実験では通信路が減衰の影響を受ける場合について考える。
図6は減衰の影響について表した。
減衰を受けることにより、平均$\mu$は$\sqrt{k}\mu$となる。
また、共分散行列$A$は、$kA+ (1-k)/4　$となる。ここで、$ｋ$は透過率を表す。ただし、コヒーレント状態の場合、共分散行列は減衰によって変化しない。
<center>

<img src="https://drive.google.com/uc?export=view&id=1XEtjSyqDN7jpcNY1dwUW7YrvGV4YAwvr">

図6　減衰の影響
</center>



図7は、今回の評価実験の構成図になる。この通信路が透過率$ｋ$の減衰の影響を受けている。
ここで、送信器の信号の最大強度の設定を$S_{max}$。受信機の信号の最大強度の設定を$S'_{max}$とする。
実験では$S_{max}$と$S´_{max}$が等しい場合と減衰の効果を考慮して$S´_{max}$を決める場合について実験を行った。
また、今回の実験では受信器は乱数を発生させてシミュレートした。
<center>
<img src="https://drive.google.com/uc?export=view&id=19ziPD2J4XC4eSJ_LrLFPsFaBsy58eFzx">
</center>
図7　減衰がある場合の正規受信者の誤り率


図8は信号の最大強度が5、基底数が256、送信データ数が1000個の場合に透過率と正規受信者の誤り率の関係を表したものである。また、縦軸は誤り率、横軸は透過率で、透過率を0〜0.０5づつ1.0まで上げた際の変化をまとめた。グラフからわかる通り、信号の最大強度を調整することで、0.05〜0.6の間で誤り率を大幅に減らすことができることがわかる。また透過率が0.8~1.0の範囲では信号の最大強度を調整しなくても信号の誤り率が低くなることがわかる。
<center>
<img src="https://drive.google.com/uc?export=view&id=1TRr6SXBIi1q55Iq1MCry72Jzubrfa1Zi">
図8　透過率と正規受信者の誤り率の関係
</center>



```python

```

　コヒーレント状態$|\alpha\rangle$は、理想的なレーザー光を表している量子状態で、複素振幅$\alpha=x+iy$を持っている。また複素平面上で平均ベクトル$(x,y)^T$と共分散行列
$$
\begin{pmatrix}
1/4&0\\
0&1/4
\end{pmatrix}
$$
の正規分布に従って揺らいでいる。そしてコヒーレント状態を一般化したものが量子ガウス状態である。量子ガウス状態は、平均ベクトル$(x,y)^T$と共分散行列
$$
\begin{pmatrix}
a&c\\
c&b
\end{pmatrix}
$$
で表される。ただし共分散行列の要素は、関係式
$a+b\geq 0$,$ab-c^2\geq1/16$
を満たす必要がある。
スクイズド状態$|\alpha,\zeta\rangle$はガウス状態の一種で、図1のように量子揺らぎを持っている。スクイズド状態は、複素数$\alpha,\zeta$によって特徴づけられる。特に$\alpha$を$x+iy$,$\zeta$を$re^{i\theta}$とすると、
$$\begin{split}
a&=1/4[\cosh 2r-\sinh 2r\cos\theta]\\
b&=1/4[\cosh 2r+\sinh 2r\cos\theta]\\
c&=1/4\sinh 2r\sin\theta
\end{split}$$
によって平均ベクトル$(x,y)^T$と共分散行列$$\begin{pmatrix}
a&c\\
c&b
\end{pmatrix}
$$が決まる。
<center>
<img src="https://drive.google.com/uc?export=view&id=13tbuwy1UkZC4n6cigHWfQS1ObsZ_oKCd">

図1：スクイズド状態
</center>
　



```python

```
